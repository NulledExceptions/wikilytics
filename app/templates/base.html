<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="/static/css/bootstrap.css" rel="stylesheet" media="screen">
    <link href="/static/css/bootstrap-theme.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />

    <link href="/static/css/dc.css" rel="stylesheet">
    <link href="/static/css/jquery-ui.css" rel="stylesheet">
    <link href="/static/css/custom.css" rel="stylesheet">
    <script src="/static/js/jquery-3.1.1.min.js"></script>
    <script src="/static/js/jquery-ui.js"></script>
    <link href="/static/css/d3-tooltips.css" rel="stylesheet">



</head>

  <body>

  {% include "navbar.html" %}



            {% block content %}{% endblock %}



    <script src="/static/js/bootstrap.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.min.js">
        </script>
    <script src="/static/js/effects.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.0-dev/dc.js"></script>
    <script src="/static/js/d3-tooltips.js"></script>

    <script src="/static/js/graph.js"></script>
    <script src="/static/js/responsive.js"></script>

    <script>

    $( document ).ready(function() {
        
        data = '{{ data }}'
        query =  '{{ query }}'    

        if(data && data != "None") {

            data = data.replace(/l&#39;/g,'l_')
            data = data.replace(/d&#39;/g,'d_')
            data = data.replace(/u&#39;/g,'"')
            data = data.replace(/&#39;/g,'"')
            data = data.replace(/u&#34;/g,'"')
            data = data.replace(/&#34;/g,'"')
            data = data.replace(/[\])[(]/g, '')
            data = '['+data+']'

            json = JSON.parse(data)
            renderDashboardCharts(json, query);
        }
        
        $( function() {
            $( ".datepicker" ).datepicker();
        } );
    });
    

    $(window).resize(function(){
      setChartWidth();
      dc.renderAll();
    });

    var start = moment().subtract(29, 'days');
    var end = moment();

    function cb(start, end) {
        $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
    }

    $('input#datarangepicker').daterangepicker({
        startDate: start,
        endDate: end,
        ranges: {
           'Today': [moment(), moment()],
           'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
           'Last 7 Days': [moment().subtract(6, 'days'), moment()],
           'Last 30 Days': [moment().subtract(29, 'days'), moment()],
           'This Month': [moment().startOf('month'), moment().endOf('month')],
           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
        }
    }, cb);

    cb(start, end);

	</script>

  </body>
</html>